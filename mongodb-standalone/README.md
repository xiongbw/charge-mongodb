# mongodb-standalone

## æ¨¡å—ä»‹ç»

ä¸»è¦æ˜¯ä½¿ç”¨ `Spring Boot` ä¸ **å•å®ä¾‹** `MongoDB(4.4.16)` ç›¸ç»“åˆçš„ä¸€äº›å®ä¾‹ã€‚
1. `MongoTemplate` å’Œ `MongoRepository` çš„ä½¿ç”¨ï¼›
2. ä¸ `MongoDB` çš„æ–°ç‰¹æ€§â€”â€”äº‹åŠ¡ç»“åˆä½¿ç”¨ï¼›
3. `MongoDB` ä¸ `MySQL` ç»“åˆäºåŒä¸€äº‹åŠ¡ç®¡ç†ã€‚

## æ­å»ºï¼ˆå•å®ä¾‹ï¼‰å¤åˆ¶é›†

> Qï¼šè¯¥æ¨¡å—æ˜¯ä¸ `MongoDB` å•å®ä¾‹çš„ç»“åˆï¼Œä¸ºä»€ä¹ˆè¿˜è¦æ­å»ºå¤åˆ¶é›†ï¼Ÿ
>
> Aï¼šæœ¬é¡¹ç›®ä½¿ç”¨çš„ `MongoDB` ç‰ˆæœ¬ä¸º `4.4`ï¼Œè¯¥æ¨¡å—ä¸­æœ‰ä¸ `MongoDB` äº‹åŠ¡ç‰¹æ€§ç»“åˆä½¿ç”¨ï¼›
> è€Œ `MongoDB` ä» `4.0` ç‰ˆæœ¬å¼€å§‹**æ”¯æŒå¤åˆ¶é›†éƒ¨ç½²æ¨¡å¼ä¸‹çš„äº‹åŠ¡** ï¼Œæ‰€ä»¥éœ€è¦æ­å»ºä¸€ä¸ª**å•å®ä¾‹çš„å¤åˆ¶é›†**ï¼ˆå¾ˆç®€å•ï¼Œä¸æ­å»ºä¼šæŠ¥é”™ğŸ˜‚

### æ­å»ºå•å®ä¾‹

å®‰è£…è¿‡ç¨‹å¯è§ [Windowsã€macOS å’Œ Linux å›¾æ–‡å®‰è£…](https://mp.weixin.qq.com/s/yaPbuUqMF_4oFkaoCqilJQ)

æ¥ä¸‹æ¥å°±æ˜¯å°†å®ƒå˜æˆä¸€ä¸ªåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„å¤åˆ¶é›†ã€‚

### ä¿®æ”¹é…ç½®æ–‡ä»¶
æ–°å¢é…ç½®é¡¹
```properties
# è®¾ç½®ç»‘å®šçš„å¤åˆ¶é›†åå­—
replSet = standalone
```

### è®¾ç½®å¤åˆ¶é›†
1. è¿›å…¥ `MongoDB` æœåŠ¡
2. é…ç½®å¤åˆ¶é›†
```javascript
rs.initiate({
    _id: "standalone",
    "members": [
        {
            "_id": 0,
            "host": "localhost:27017"
        }
    ]
})
```

ä½ çš„ `mongo` å‘½ä»¤è¡Œä¼šå…ˆä» `>` å˜æˆ `standalone:SECONDARY>`ï¼Œå†å˜æˆ `standalone:PRIMARY>`

1. æ­¤æ—¶æˆ‘ä»¬çš„èŠ‚ç‚¹å·²ç»è¿›å…¥äº†å¤åˆ¶é›†çš„çŠ¶æ€ï¼Œæˆ‘ä»¬çš„èŠ‚ç‚¹ä¸å†æ˜¯ä¸ªå•ç‹¬çš„èŠ‚ç‚¹ï¼Œæ˜¯ä¸ªå¤åˆ¶é›†çš„èŠ‚ç‚¹
2. å¾ˆæ˜¾ç„¶ï¼Œstandalone å°±æ˜¯æˆ‘ä»¬å¤åˆ¶é›†çš„åç§°
3. SECONDARY å°±æ˜¯ä»èŠ‚ç‚¹çš„æ„æ€ï¼Œåˆšå¼€å§‹çš„çŠ¶æ€è‚¯å®šæ˜¯å…ˆä» SECONDARY å¼€å§‹ï¼Œç„¶åå†è¿›åˆ°ä¸»èŠ‚ç‚¹
4. è¿™ä¸ªæ—¶å€™å†æŒ‰ä¸‹å›è½¦ï¼Œæˆ‘ä»¬çš„å‘½ä»¤è¡Œæ ‡è¯†å°±å˜æˆäº† `standalone:PRIMARY>`
5. æ­¤æ—¶ï¼Œè¯¥èŠ‚ç‚¹å°±åœ¨åˆšåˆšå·²ç»ç”±**ä»èŠ‚ç‚¹**è§’è‰²å˜æˆäº†**ä¸»èŠ‚ç‚¹**è§’è‰²ã€‚

## æ•°æ®å‡†å¤‡
è§£å‹ `resource` ç›®å½•ä¸‹çš„ `dump.7z`ï¼Œä½¿ç”¨[æ•°æ®åº“å·¥å…·](https://www.mongodb.com/try/download/database-tools)çš„ `mongorestore` å¤‡ä»½å·¥å…·ï¼Œå¯¼å…¥ 10,0000 æ¡è®¢å• `db_charge.order` æ•°æ®ã€‚
```shell
mongorestore -h 127.0.0.1:27017 dump
```